{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":null,"links":[{"title":"Front","url":"/d/gaqno-dashboard-front","type":"dashboard"},{"title":"Backend","url":"/d/gaqno-dashboard-backend","type":"dashboard"},{"title":"DevOps","url":"/d/gaqno-dashboard-devops","type":"dashboard"},{"title":"DNS droppage","url":"/d/gaqno-dns-droppage","type":"dashboard"}],"liveNow":false,"panels":[{"fieldConfig":{"defaults":{"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":0.7},{"color":"red","value":0.9}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":6,"w":4,"x":0,"y":0},"id":10,"options":{"minVizHeight":75,"minVizWidth":75,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"sizing":"auto"},"pluginVersion":"12.4.0","targets":[{"expr":"1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))","instant":true,"legendFormat":"CPU Usage","refId":"A"}],"title":"Server CPU Usage","type":"gauge"},{"fieldConfig":{"defaults":{"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":0.7},{"color":"red","value":0.9}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":6,"w":4,"x":4,"y":0},"id":11,"options":{"minVizHeight":75,"minVizWidth":75,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"sizing":"auto"},"pluginVersion":"12.4.0","targets":[{"expr":"1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)","instant":true,"legendFormat":"RAM Usage","refId":"A"}],"title":"Server RAM Usage","type":"gauge"},{"fieldConfig":{"defaults":{"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":0.7},{"color":"red","value":0.9}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":6,"w":4,"x":8,"y":0},"id":12,"options":{"minVizHeight":75,"minVizWidth":75,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"sizing":"auto"},"pluginVersion":"12.4.0","targets":[{"expr":"1 - (node_filesystem_avail_bytes{mountpoint=\"/\"} / node_filesystem_size_bytes{mountpoint=\"/\"})","instant":true,"legendFormat":"Disk Usage","refId":"A"}],"title":"Disk Usage","type":"gauge"},{"datasource":{"type":"prometheus"},"fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":6,"x":12,"y":0},"id":13,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"12.4.0","targets":[{"expr":"count(container_info{service!=\"\"})","instant":true,"legendFormat":"Containers","refId":"A"}],"title":"Running Containers","type":"stat"},{"fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0}]},"unit":"dtdurations"},"overrides":[]},"gridPos":{"h":6,"w":6,"x":18,"y":0},"id":14,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"12.4.0","targets":[{"expr":"time() - node_boot_time_seconds","instant":true,"legendFormat":"Uptime","refId":"A"}],"title":"Server Uptime","type":"stat"},{"fieldConfig":{"defaults":{"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":0.25},{"color":"red","value":0.5}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":10,"w":12,"x":0,"y":6},"id":3,"options":{"displayMode":"gradient","legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"horizontal","reduceOptions":{"calcs":["last"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"12.4.0","targets":[{"expr":"topk(10, sum by (component) (label_replace(rate(container_cpu_usage_seconds_total{id=~\"/system.slice/docker.*\",cpu=\"total\"}[5m]),\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"}))","instant":true,"legendFormat":"{{component}}","refId":"A"}],"title":"Top 10 CPU Consumers","type":"bargauge"},{"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","showValues":false,"spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"red","value":80}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":10,"w":12,"x":12,"y":6},"id":1,"options":{"legend":{"calcs":["mean","max","last"],"displayMode":"table","placement":"right","showLegend":true,"sortBy":"Mean","sortDesc":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.4.0","targets":[{"expr":"sum by (component) (label_replace(rate(container_cpu_usage_seconds_total{id=~\"/system.slice/docker.*\",cpu=\"total\"}[5m]),\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"})","legendFormat":"{{component}}","refId":"A"}],"title":"CPU Usage per Service","type":"timeseries"},{"fieldConfig":{"defaults":{"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"yellow","value":536870912},{"color":"red","value":1073741824}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":10,"w":12,"x":0,"y":16},"id":4,"options":{"displayMode":"gradient","legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"horizontal","reduceOptions":{"calcs":["last"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"12.4.0","targets":[{"expr":"topk(10, sum by (component) (label_replace(container_memory_usage_bytes{id=~\"/system.slice/docker.*\"},\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"}))","instant":true,"legendFormat":"{{component}}","refId":"A"}],"title":"Top 10 Memory Consumers","type":"bargauge"},{"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","showValues":false,"spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":10,"w":12,"x":12,"y":16},"id":2,"options":{"legend":{"calcs":["mean","max","last"],"displayMode":"table","placement":"right","showLegend":true,"sortBy":"Mean","sortDesc":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.4.0","targets":[{"expr":"sum by (component) (label_replace(container_memory_usage_bytes{id=~\"/system.slice/docker.*\"},\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"})","legendFormat":"{{component}}","refId":"A"}],"title":"Memory Usage per Service","type":"timeseries"},{"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","showValues":false,"spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"red","value":80}]},"unit":"Bps"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":26},"id":5,"options":{"legend":{"calcs":["mean","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.4.0","targets":[{"expr":"sum by (component) (label_replace(rate(container_network_receive_bytes_total{id=~\"/system.slice/docker.*\"}[5m]),\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"})","legendFormat":"{{component}}","refId":"A"}],"title":"Network I/O per Service (Receive)","type":"timeseries"},{"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","showValues":false,"spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":0},{"color":"red","value":80}]},"unit":"Bps"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":26},"id":6,"options":{"legend":{"calcs":["mean","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.4.0","targets":[{"expr":"sum by (component) (label_replace(rate(container_network_transmit_bytes_total{id=~\"/system.slice/docker.*\"}[5m]),\"container_id\",\"$1\",\"id\",\"/system.slice/docker-(.*)\\\\.scope\") * on(container_id) group_left(component) container_info{service!=\"\"})","legendFormat":"{{component}}","refId":"A"}],"title":"Network I/O per Service (Transmit)","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":34},"id":30,"panels":[],"title":"Quick links — Dashboards","type":"row"},{"gridPos":{"h":4,"w":24,"x":0,"y":35},"id":31,"options":{"content":"| Dashboard | Description |\n|-----------|-------------|\n| [**Services Overview**](/d/services-overview) | This page |\n| [**Front**](/d/gaqno-dashboard-front) | UIs, 4xx/5xx by app |\n| [**Backend**](/d/gaqno-dashboard-backend) | Services, 4xx/5xx by service |\n| [**DevOps**](/d/gaqno-dashboard-devops) | Host, containers, Prometheus |\n| [**DNS droppage**](/d/gaqno-dns-droppage) | Cloudflare DNS non-NOERROR |","mode":"markdown"},"title":"","type":"text"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":39},"id":20,"panels":[],"title":"Cloudflare status — 503 / 5xx","type":"row"},{"gridPos":{"h":4,"w":24,"x":0,"y":40},"id":21,"options":{"content":"**[Open Cloudflare Status →](https://www.cloudflarestatus.com/)** — Live incidents. Panels below: 503/5xx from your zone (Infinity + Zone ID required).","mode":"markdown"},"title":"","type":"text"},{"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"description":"HTTP 503 in selected period. Requires Infinity + Zone ID.","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":1},{"color":"red","value":10}]},"unit":"short"},"overrides":[]},"gridPos":{"h":5,"w":6,"x":0,"y":44},"id":22,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":true},"textMode":"auto"},"pluginVersion":"12.4.0","targets":[{"columns":[{"selector":"dimensions.edgeResponseStatus","text":"status","type":"string"},{"selector":"count","text":"count","type":"number"}],"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"format":"table","refId":"A","root_selector":"data.viewer.zones[0].httpRequestsAdaptiveGroups","source":"url","type":"graphql","url":"https://api.cloudflare.com/client/v4/graphql","url_options":{"body_content_type":"application/json","body_graphql_query":"query Viewer { viewer { zones(filter: { zoneTag: \"${zone_id}\" }) { zoneTag httpRequestsAdaptiveGroups(limit: 100 filter: { datetime_geq: \"${__from:date:YYYY-MM-DDTHH:mm:ssZ}\" datetime_leq: \"${__to:date:YYYY-MM-DDTHH:mm:ssZ}\" }) { count dimensions { edgeResponseStatus } } } } }","body_type":"graphql","method":"POST"}}],"title":"503 count (selected period)","transformations":[{"id":"filterByValue","options":{"match":"all","filters":[{"fieldName":"dimensions.edgeResponseStatus","config":{"id":"string","options":{"value":"503"}},"operator":"equals"}]}},{"id":"reduce","options":{"reducers":["sum"]}}],"type":"stat"},{"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[{"matcher":{"id":"byName","options":"count"},"properties":[{"id":"custom.width","value":100}]}]},"gridPos":{"h":5,"w":9,"x":6,"y":44},"id":23,"options":{"footer":{"countRows":false,"fields":"","reducer":["sum"],"show":true},"showHeader":true},"pluginVersion":"12.4.0","targets":[{"columns":[{"selector":"dimensions.edgeResponseStatus","text":"HTTP status","type":"string"},{"selector":"count","text":"Count","type":"number"}],"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"format":"table","refId":"A","root_selector":"data.viewer.zones[0].httpRequestsAdaptiveGroups","source":"url","type":"graphql","url":"https://api.cloudflare.com/client/v4/graphql","url_options":{"body_content_type":"application/json","body_graphql_query":"query Viewer { viewer { zones(filter: { zoneTag: \"${zone_id}\" }) { zoneTag httpRequestsAdaptiveGroups(limit: 100 filter: { datetime_geq: \"${__from:date:YYYY-MM-DDTHH:mm:ssZ}\" datetime_leq: \"${__to:date:YYYY-MM-DDTHH:mm:ssZ}\" }) { count dimensions { edgeResponseStatus } } } } }","body_type":"graphql","method":"POST"}}],"title":"Requests by HTTP status","type":"table"},{"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisPlacement":"auto","drawStyle":"line","fillOpacity":10,"gradientMode":"none","lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":6,"w":24,"x":0,"y":49},"id":24,"options":{"legend":{"displayMode":"list","placement":"bottom","showLegend":true}},"pluginVersion":"12.4.0","targets":[{"columns":[{"selector":"count","text":"Requests","type":"number"},{"selector":"dimensions.datetimeMinute","text":"Time","type":"timestamp"},{"selector":"dimensions.edgeResponseStatus","text":"status","type":"string"}],"datasource":{"type":"yesoreyeram-infinity-datasource","uid":"${infinity_datasource}"},"format":"table","refId":"A","root_selector":"data.viewer.zones[0].httpRequestsAdaptiveGroups","source":"url","type":"graphql","url":"https://api.cloudflare.com/client/v4/graphql","url_options":{"body_content_type":"application/json","body_graphql_query":"query Viewer { viewer { zones(filter: { zoneTag: \"${zone_id}\" }) { zoneTag httpRequestsAdaptiveGroups(limit: 5000 filter: { datetime_geq: \"${__from:date:YYYY-MM-DDTHH:mm:ssZ}\" datetime_leq: \"${__to:date:YYYY-MM-DDTHH:mm:ssZ}\" }) { count dimensions { edgeResponseStatus datetimeMinute } } } } }","body_type":"graphql","method":"POST"}}],"title":"Requests by HTTP status over time","transformations":[{"id":"prepareTimeSeries","options":{"format":"multi"}}],"type":"timeseries"}],"preload":false,"refresh":"30s","schemaVersion":42,"style":"dark","tags":["gaqno"],"templating":{"list":[{"current":{},"datasource":{"type":"yesoreyeram-infinity-datasource","uid":""},"definition":"","hide":0,"includeAll":false,"label":"Infinity (Cloudflare)","multi":false,"name":"infinity_datasource","options":[],"query":"yesoreyeram-infinity-datasource","refresh":1,"skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"","value":""},"hide":0,"label":"Zone ID","name":"zone_id","options":[],"query":"","skipUrlSync":false,"type":"text"}]},"time":{"from":"now-1h","to":"now"},"timepicker":{},"timezone":"browser","title":"Services Overview","uid":"services-overview","version":11,"weekStart":"","__requires":[{"type":"panel","id":"gauge","name":"Gauge","version":""},{"type":"panel","id":"stat","name":"Stat","version":""},{"type":"panel","id":"bargauge","name":"Bar gauge","version":""},{"type":"panel","id":"timeseries","name":"Time series","version":""},{"type":"panel","id":"text","name":"Text","version":""},{"type":"datasource","id":"yesoreyeram-infinity-datasource","name":"Infinity","version":""}],"meta":{"grafana.app/saved-from-ui":false}}
